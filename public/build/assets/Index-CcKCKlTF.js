import{j as e,r as x,H as R,k as w}from"./app-Cwhk-y-Q.js";import{M as H,C as P,W as A}from"./MainLayout-DG_h4u18.js";import{a as D,f as E}from"./dateFormat-TyM5950g.js";import{G as l}from"./Grid-ClWOtsL_.js";import{b as L,C as c,d as a,B as d,T as r,e as M,P as h}from"./Schedule-DiIcUQZb.js";import{T as k}from"./TextField-B5TSfn_l.js";import{P as B}from"./Person-IF5kxVxm.js";import{T as j,a as m,b as p,c as i,d as n,e as u}from"./TableRow-UwqfMSIv.js";const W=L(e.jsx("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}));function K(){const[C,b]=x.useState(!1),[t,T]=x.useState(null),[o,_]=x.useState(""),[f,z]=x.useState(new Date().toISOString().slice(0,7)),v=[{title:"التقرير الشهري",description:"ملخص المناوبات الشهرية",icon:e.jsx(P,{}),type:"monthly"},{title:"تقرير الموظفين",description:"إحصائيات كل موظف",icon:e.jsx(B,{}),type:"employees"},{title:"تقرير الأرصدة",description:"حالة الأرصدة والاستخدام",icon:e.jsx(A,{}),type:"balances"},{title:"سجل العمليات",description:"آخر العمليات في النظام",icon:e.jsx(W,{}),type:"logs"}],g=async s=>{b(!0),_(s);try{const y=s==="monthly"?{month:f}:{},S=await w.get(`/reports/${s}`,{params:y});T(S.data)}catch(y){console.error("Error fetching report:",y)}b(!1)},I=()=>{if(C)return e.jsx(d,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(M,{})});if(!t)return null;switch(o){case"monthly":return e.jsxs(d,{children:[e.jsxs(l,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(l,{size:{xs:6,sm:3},children:e.jsx(c,{variant:"outlined",children:e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",children:t.stats.total}),e.jsx(r,{color:"text.secondary",children:"إجمالي المناوبات"})]})})}),e.jsx(l,{size:{xs:6,sm:3},children:e.jsx(c,{variant:"outlined",children:e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"success.main",children:t.stats.completed}),e.jsx(r,{color:"text.secondary",children:"مكتملة"})]})})}),e.jsx(l,{size:{xs:6,sm:3},children:e.jsx(c,{variant:"outlined",children:e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"warning.main",children:t.stats.substituted}),e.jsx(r,{color:"text.secondary",children:"تم تبديلها"})]})})}),e.jsx(l,{size:{xs:6,sm:3},children:e.jsx(c,{variant:"outlined",children:e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"error.main",children:t.stats.absent}),e.jsx(r,{color:"text.secondary",children:"غياب"})]})})})]}),e.jsx(j,{component:h,elevation:0,children:e.jsxs(m,{size:"small",children:[e.jsx(p,{children:e.jsxs(i,{children:[e.jsx(n,{children:"التاريخ"}),e.jsx(n,{children:"اليوم"}),e.jsx(n,{children:"الموظف"}),e.jsx(n,{children:"الحالة"})]})}),e.jsx(u,{children:t.shifts.map(s=>e.jsxs(i,{children:[e.jsx(n,{children:E(s.shift_date)}),e.jsx(n,{children:s.day_name}),e.jsx(n,{children:s.employee?.name}),e.jsx(n,{children:s.status})]},s.id))})]})})]});case"employees":return e.jsx(j,{component:h,elevation:0,children:e.jsxs(m,{children:[e.jsx(p,{children:e.jsxs(i,{children:[e.jsx(n,{children:"الموظف"}),e.jsx(n,{children:"إجمالي المناوبات"}),e.jsx(n,{children:"المكتملة"}),e.jsx(n,{children:"الأرصدة المتاحة"})]})}),e.jsx(u,{children:t.employees.map(s=>e.jsxs(i,{children:[e.jsx(n,{children:s.name}),e.jsx(n,{children:s.shifts_count}),e.jsx(n,{children:s.completed_shifts_count}),e.jsx(n,{children:s.available_balances_count})]},s.id))})]})});case"balances":return e.jsxs(d,{children:[e.jsx(r,{variant:"h6",sx:{mb:2},children:"ملخص الأرصدة"}),e.jsx(j,{component:h,elevation:0,children:e.jsxs(m,{children:[e.jsx(p,{children:e.jsxs(i,{children:[e.jsx(n,{children:"الموظف"}),e.jsx(n,{children:"متاح"}),e.jsx(n,{children:"مستخدم"}),e.jsx(n,{children:"منتهي"})]})}),e.jsx(u,{children:t.byEmployee.map(s=>e.jsxs(i,{children:[e.jsx(n,{children:s.name}),e.jsx(n,{children:s.available_count}),e.jsx(n,{children:s.used_count}),e.jsx(n,{children:s.expired_count})]},s.id))})]})})]});case"logs":return e.jsx(j,{component:h,elevation:0,children:e.jsxs(m,{size:"small",children:[e.jsx(p,{children:e.jsxs(i,{children:[e.jsx(n,{children:"التاريخ"}),e.jsx(n,{children:"العملية"}),e.jsx(n,{children:"الوصف"}),e.jsx(n,{children:"المستخدم"})]})}),e.jsx(u,{children:t.logs.map(s=>e.jsxs(i,{children:[e.jsx(n,{children:D(s.created_at)}),e.jsx(n,{children:s.action}),e.jsx(n,{children:s.description}),e.jsx(n,{children:s.user?.name||"-"})]},s.id))})]})});default:return null}};return e.jsxs(H,{title:"التقارير",children:[e.jsx(R,{title:"التقارير"}),e.jsx(l,{container:!0,spacing:3,sx:{mb:3},children:v.map(s=>e.jsx(l,{size:{xs:12,sm:6,md:3},children:e.jsx(c,{sx:{cursor:"pointer",transition:"all 0.3s","&:hover":{transform:"translateY(-4px)",boxShadow:4,borderColor:"primary.main"},border:o===s.type?2:1,borderColor:o===s.type?"primary.main":"divider"},onClick:()=>g(s.type),children:e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(d,{sx:{color:"primary.main",mb:1},children:s.icon}),e.jsx(r,{variant:"h6",fontWeight:600,children:s.title}),e.jsx(r,{variant:"body2",color:"text.secondary",children:s.description})]})})},s.type))}),o==="monthly"&&e.jsx(d,{sx:{mb:2},children:e.jsx(k,{type:"month",label:"الشهر",value:f,onChange:s=>{z(s.target.value),g("monthly")},size:"small",InputLabelProps:{shrink:!0}})}),t&&e.jsx(c,{children:e.jsxs(a,{children:[e.jsx(r,{variant:"h6",sx:{mb:2},children:v.find(s=>s.type===o)?.title}),I()]})})]})}export{K as default};
