import{r as v,a as A,c as H,j as t,b as S,H as U,d as I,k as F}from"./app-Cwhk-y-Q.js";import{M as L,D as T}from"./MainLayout-DG_h4u18.js";import{g as V,a as X,u as B,c as G,s as C,m as k,v as q,b as J,C as P,d as M,B as u,S as K,T as f,P as Q}from"./Schedule-DiIcUQZb.js";import{T as Y,a as Z,b as ee,c as R,d as l,e as te}from"./TableRow-UwqfMSIv.js";import{S as se,C as D}from"./Checkbox-0if0cGsc.js";import{T as z}from"./TextField-B5TSfn_l.js";import{B as W}from"./Button-bpof-n8Y.js";import{S as ae}from"./Save-Ub1bZzSp.js";import{S as ie}from"./Snackbar-DrVTsFTV.js";import{A as oe}from"./Alert-BPajDfgF.js";function ne(e){return V("MuiSwitch",e)}const i=X("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),re=e=>{const{classes:a,edge:o,size:n,color:j,checked:m,disabled:w}=e,d={root:["root",o&&`edge${S(o)}`,`size${S(n)}`],switchBase:["switchBase",`color${S(j)}`,m&&"checked",w&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},p=G(d,ne,a);return{...a,...p}},ce=C("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.root,o.edge&&a[`edge${S(o.edge)}`],a[`size${S(o.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${i.thumb}`]:{width:16,height:16},[`& .${i.switchBase}`]:{padding:4,[`&.${i.checked}`]:{transform:"translateX(16px)"}}}}]}),le=C(se,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.switchBase,{[`& .${i.input}`]:a.input},o.color!=="default"&&a[`color${S(o.color)}`]]}})(k(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${i.checked}`]:{transform:"translateX(20px)"},[`&.${i.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${i.checked} + .${i.track}`]:{opacity:.5},[`&.${i.disabled} + .${i.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${i.input}`]:{left:"-100%",width:"300%"}})),k(({theme:e})=>({"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(q(["light"])).map(([a])=>({props:{color:a},style:{[`&.${i.checked}`]:{color:(e.vars||e).palette[a].main,"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[a].main,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${i.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${a}DisabledColor`]:`${e.palette.mode==="light"?e.lighten(e.palette[a].main,.62):e.darken(e.palette[a].main,.55)}`}},[`&.${i.checked} + .${i.track}`]:{backgroundColor:(e.vars||e).palette[a].main}}}))]}))),de=C("span",{name:"MuiSwitch",slot:"Track"})(k(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),pe=C("span",{name:"MuiSwitch",slot:"Thumb"})(k(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),he=v.forwardRef(function(a,o){const n=A({props:a,name:"MuiSwitch"}),{className:j,color:m="primary",edge:w=!1,size:d="medium",sx:p,slots:x={},slotProps:r={},...b}=n,h={...n,color:m,edge:w,size:d},g=re(h),s={slots:x,slotProps:r},[c,$]=B("root",{className:H(g.root,j),elementType:ce,externalForwardedProps:s,ownerState:h,additionalProps:{sx:p}}),[y,E]=B("thumb",{className:g.thumb,elementType:pe,externalForwardedProps:s,ownerState:h}),_=t.jsx(y,{...E}),[N,O]=B("track",{className:g.track,elementType:de,externalForwardedProps:s,ownerState:h});return t.jsxs(c,{...$,children:[t.jsx(le,{type:"checkbox",icon:_,checkedIcon:_,ref:o,ownerState:h,...b,classes:{...g,root:g.switchBase},slots:{...x.switchBase&&{root:x.switchBase},...x.input&&{input:x.input}},slotProps:{...r.switchBase&&{root:typeof r.switchBase=="function"?r.switchBase(h):r.switchBase},input:{role:"switch"},...r.input&&{input:typeof r.input=="function"?r.input(h):r.input}}}),t.jsx(N,{...O})]})}),xe=J(t.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"})),ue=["السبت","الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة"];function Ce({settings:e}){const[a,o]=v.useState(e.notifications_enabled),[n,j]=v.useState(e.shift_settings),[m,w]=v.useState(e.balance_expiry_days),[d,p]=v.useState({open:!1,message:"",severity:"success"}),[x,r]=v.useState(!1),b=(s,c,$)=>{j(y=>({...y,[s]:{...y[s],[c]:$}}))},h=async()=>{r(!0);try{await F.post("/settings/shifts",{shift_settings:n}),p({open:!0,message:"تم حفظ إعدادات المناوبات بنجاح",severity:"success"})}catch{p({open:!0,message:"حدث خطأ أثناء حفظ الإعدادات",severity:"error"})}r(!1)},g=()=>{I.post("/settings/update",{key:"balance_expiry_days",value:m.toString()},{onSuccess:()=>{p({open:!0,message:"تم حفظ الإعدادات بنجاح",severity:"success"})}})};return t.jsxs(L,{title:"الإعدادات",children:[t.jsx(U,{title:"الإعدادات"}),t.jsx(P,{sx:{mb:3},children:t.jsxs(M,{children:[t.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[t.jsx(K,{color:"primary"}),t.jsx(f,{variant:"h6",fontWeight:600,children:"إعدادات أوقات المناوبات"})]}),t.jsx(T,{sx:{mb:2}}),t.jsx(Y,{component:Q,elevation:0,children:t.jsxs(Z,{size:"small",children:[t.jsx(ee,{children:t.jsxs(R,{children:[t.jsx(l,{sx:{fontWeight:600},children:"اليوم"}),t.jsx(l,{sx:{fontWeight:600},children:"مفعل"}),t.jsx(l,{sx:{fontWeight:600},children:"وقت البداية"}),t.jsx(l,{sx:{fontWeight:600},children:"وقت النهاية"}),t.jsx(l,{sx:{fontWeight:600},children:"يوم إضافي"})]})}),t.jsx(te,{children:ue.map(s=>t.jsxs(R,{hover:!0,children:[t.jsx(l,{children:t.jsx(f,{fontWeight:500,children:s})}),t.jsx(l,{children:t.jsx(D,{checked:n[s]?.enabled??!0,onChange:c=>b(s,"enabled",c.target.checked)})}),t.jsx(l,{children:t.jsx(z,{type:"time",size:"small",value:n[s]?.start_time||"13:00",onChange:c=>b(s,"start_time",c.target.value),disabled:!n[s]?.enabled,sx:{width:130}})}),t.jsx(l,{children:t.jsx(z,{type:"time",size:"small",value:n[s]?.end_time||"06:00",onChange:c=>b(s,"end_time",c.target.value),disabled:!n[s]?.enabled,sx:{width:130}})}),t.jsx(l,{children:t.jsx(D,{checked:n[s]?.has_extra_day??!1,onChange:c=>b(s,"has_extra_day",c.target.checked),disabled:!n[s]?.enabled})})]},s))})]})}),t.jsx(u,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:t.jsx(W,{variant:"contained",startIcon:t.jsx(ae,{}),onClick:h,disabled:x,children:x?"جاري الحفظ...":"حفظ إعدادات المناوبات"})})]})}),t.jsx(P,{sx:{mb:3},children:t.jsxs(M,{children:[t.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[t.jsx(xe,{color:"primary"}),t.jsx(f,{variant:"h6",fontWeight:600,children:"إعدادات عامة"})]}),t.jsx(T,{sx:{mb:2}}),t.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(u,{children:[t.jsx(f,{fontWeight:500,children:"إشعارات البريد الإلكتروني"}),t.jsx(f,{variant:"body2",color:"text.secondary",children:"إرسال تنبيهات المناوبات والأرصدة عبر البريد"})]}),t.jsx(he,{checked:a,onChange:s=>{o(s.target.checked),I.post("/settings/update",{key:"notifications_enabled",value:s.target.checked?"true":"false"})}})]}),t.jsx(T,{}),t.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[t.jsxs(u,{sx:{flex:1},children:[t.jsx(f,{fontWeight:500,children:"مدة صلاحية الرصيد (بالأيام)"}),t.jsx(f,{variant:"body2",color:"text.secondary",children:"عدد الأيام قبل انتهاء صلاحية رصيد اليوم الإضافي"})]}),t.jsx(z,{type:"number",size:"small",value:m,onChange:s=>w(parseInt(s.target.value)||7),sx:{width:100},inputProps:{min:1,max:30}}),t.jsx(W,{variant:"outlined",size:"small",onClick:g,children:"حفظ"})]})]})]})}),t.jsx(ie,{open:d.open,autoHideDuration:4e3,onClose:()=>p({...d,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"left"},children:t.jsx(oe,{severity:d.severity,onClose:()=>p({...d,open:!1}),children:d.message})})]})}export{Ce as default};
